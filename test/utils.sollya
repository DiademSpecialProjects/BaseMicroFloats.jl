w;

procedure intexp(x) { return [| mantissa(x), exponent(x) |]; };

procedure rnprec(p, x) { return round(x, p, RN); };
procedure ruprec(p, x) { return round(x, p, RU); };
procedure rdprec(p, x) { return round(x, p, RD); };

# degree(poly) the degree of poly
# coeff(poly, n) the coeff of degree n in poly
#  while (expm1(i) > 0) do { expm1(i); i := i - 1; };
# > for i from 1 to 5 do print ("Hello world",i)

procedure listofcoeffs(poly) {
  mindeg = 0;
  maxdeg = degree(poly);
  lst = [| |];
  for i from mindeg to maxdeg do {
    cf = [| coeff(poly, i) |];
    lst = lst @ cf;
  };
  return lst; 
};

procedure rnprecxs(p, lstofcoeffs) {
  lst = [| |];
  for c in lstofcoeffs do {
    cf = [| rnprec(p, c) |];
    lst = lst @ cf;
  };
  return lst;
};

procedure ruprecxs(p, lstofcoeffs) {
  lst = [| |];
  for c in lstofcoeffs do {
    cf = [| ruprec(p, c) |];
    lst = lst @ cf;
  };
  return lst;
};

procedure rdprecxs(p, lstofcoeffs) {
  lst = [| |];
  for c in lstofcoeffs do {
    cf = [| rdprec(p, c) |];
    lst = lst @ cf;
  };
  return lst;
};

#=
 > p = remez(exp(x), 5, [-1;1]);
   > midpointmode=on!;
   > supnorm(p, exp(x), [-1;1], absolute, 2^(-40));
   0.45205513967~0/2~e-4

     > midpointmode=on!;
   > d = [1;2];
   > f = exp(cos(x)^2 + 1);
   > p = remez(1,15,d,1/f,1e-40);
   > theta=1b-60;
   > prec=default!;
   > mode=relative;
   > supnorm(p,f,d,mode,theta);
   0.30893006200251428~5/6~e-13

   P = fpminimax(sin(x),6,[|32...|],[-1b-5;1b-5], fixed, absolute);
   P = fpminimax(exp(x), [|3,4|], [|D,24|], [-1/256; 1/246], 1+x+x^2/2);

=#

